import{a as I,b as N,c as D,d as T,e as M,f as P,g as F,h as V,l as Y,m as k}from"./chunk-ASUJOPRX.js";import{b as E}from"./chunk-Q4VWBOSX.js";import{a as K,b as H}from"./chunk-T2HF554B.js";import{Ca as S,Gb as x,Na as C,Oa as O,Sa as g,Ta as m,Ua as s,Va as _,X as u,Y as d,Za as v,_a as y,a as f,ab as l,b as R,jb as p,sa as h,xa as b}from"./chunk-NDTBUUH6.js";function A(c,i){if(c&1){let e=v();m(0,"app-decision-modal",10),y("decision",function(r){u(e);let o=l();return d(o.recordDecision(r))})("toggleReminderOptions",function(){u(e);let r=l();return d(r.showReminderOptions=!0)})("setReminder",function(r){u(e);let o=l();return d(o.setReminder(r))})("close",function(){u(e);let r=l();return d(r.closePopup())}),s()}if(c&2){let e=l();g("itemName",e.itemForm.value.itemName)("humanReadableTime",e.humanReadableTime)("futureValue",e.futureValue)("yearsToRetirement",e.yearsToRetirement)("showReminderOptions",e.showReminderOptions)}}var $=class c{constructor(i,e){this.fb=i;this.router=e;this.itemForm=this.fb.group({itemName:[""],price:["",[N.required,N.min(.01)]]})}itemForm;showPopup=!1;showReminderOptions=!1;calculatedHours=0;humanReadableTime="";futureValue=0;yearsToRetirement=0;PROFILE_KEY="user_financial_profile";DECISIONS_KEY="purchase_decisions";REMINDERS_KEY="purchase_reminders";ngOnInit(){this.checkProfile(),this.requestNotificationPermission()}checkProfile(){localStorage.getItem(this.PROFILE_KEY)||this.router.navigate(["/profile"],{skipLocationChange:!0})}async requestNotificationPermission(){"Notification"in window&&await Notification.requestPermission()}calculateCost(){let i=this.itemForm.value.price,e=JSON.parse(localStorage.getItem(this.PROFILE_KEY)||"{}"),t=e.hourlyWage;if(!t&&e.salary){let o=e.avgHoursPerDay||8,n=e.salary,a=e.payFrequency;a==="monthly"?t=n/(21.67*o):a==="bi-weekly"?t=n/(10*o):a==="weekly"&&(t=n/(5*o))}t=t||20;let r=(e.investmentReturn||7)/100;if(this.calculatedHours=i/t,this.humanReadableTime=this.formatHours(this.calculatedHours),e.birthDate&&e.retirementAge){let o=new Date(e.birthDate),n=new Date,a=n.getFullYear()-o.getFullYear(),w=n.getMonth()-o.getMonth();(w<0||w===0&&n.getDate()<o.getDate())&&a--,this.yearsToRetirement=e.retirementAge-a,this.yearsToRetirement>0?this.futureValue=i*Math.pow(1+r,this.yearsToRetirement):this.futureValue=0}this.showPopup=!0}formatHours(i){if(i<1){let r=Math.round(i*60);return`${r} minute${r!==1?"s":""}`}let e=Math.floor(i),t=Math.round((i-e)*60);return t>0?`${e}h ${t}m`:`${e} hour${e!==1?"s":""}`}recordDecision(i){let e=JSON.parse(localStorage.getItem(this.DECISIONS_KEY)||"[]");e.push(R(f({},this.itemForm.value),{hours:this.calculatedHours,formattedTime:this.humanReadableTime,futureValue:this.futureValue,yearsToRetirement:this.yearsToRetirement,bought:i,date:new Date().toISOString()})),localStorage.setItem(this.DECISIONS_KEY,JSON.stringify(e)),i||K({particleCount:150,spread:70,origin:{y:.6},colors:["#4caf50","#81c784","#ffffff"]}),this.closePopup()}async setReminder(i){let e=f({},this.itemForm.value);this.closePopup();try{let t=new Date,r=i*60*1e3;t.setMinutes(t.getMinutes()+i);let o=R(f({},e),{id:Date.now(),hours:this.calculatedHours,formattedTime:this.humanReadableTime,remindAt:t.toISOString(),createdAt:new Date().toISOString()}),n=JSON.parse(localStorage.getItem(this.REMINDERS_KEY)||"[]");if(n.push(o),localStorage.setItem(this.REMINDERS_KEY,JSON.stringify(n)),"serviceWorker"in navigator&&"Notification"in window){let a=await navigator.serviceWorker.ready;setTimeout(()=>{a.showNotification("ByeBuyBye: Still want it?",{body:`${o.itemName||"This item"} costs ${o.formattedTime} of your work. Still worth it?`,icon:"icons/icon-192x192.png",data:{url:"/reminders"},badge:"icons/icon-72x72.png",vibrate:[200,100,200]});let J=JSON.parse(localStorage.getItem(this.REMINDERS_KEY)||"[]").filter(q=>q.id!==o.id);localStorage.setItem(this.REMINDERS_KEY,JSON.stringify(J))},r)}}catch(t){console.error("Reminder failed to set:",t)}}closePopup(){this.showPopup=!1,this.showReminderOptions=!1,this.itemForm.reset()}static \u0275fac=function(e){return new(e||c)(b(Y),b(E))};static \u0275cmp=S({type:c,selectors:[["app-new"]],decls:16,vars:3,consts:[[1,"container"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","itemName"],["type","text","id","itemName","formControlName","itemName","placeholder","e.g. New Headphones"],["for","price"],["type","number","id","price","formControlName","price","placeholder","0.00"],["type","submit",3,"disabled"],[1,"bottom-spacer"],[3,"itemName","humanReadableTime","futureValue","yearsToRetirement","showReminderOptions"],[3,"decision","toggleReminderOptions","setReminder","close","itemName","humanReadableTime","futureValue","yearsToRetirement","showReminderOptions"]],template:function(e,t){e&1&&(m(0,"div",0)(1,"h1"),p(2,"New Desired Item"),s(),m(3,"form",1),y("ngSubmit",function(){return t.calculateCost()}),m(4,"div",2)(5,"label",3),p(6,"What do you want to buy? (Optional)"),s(),_(7,"input",4),s(),m(8,"div",2)(9,"label",5),p(10,"How much does it cost?"),s(),_(11,"input",6),s(),m(12,"button",7),p(13,"Check Labor Cost"),s()()(),_(14,"div",8),C(15,A,1,5,"app-decision-modal",9)),e&2&&(h(3),g("formGroup",t.itemForm),h(9),g("disabled",t.itemForm.invalid),h(3),O(t.showPopup?15:-1))},dependencies:[x,k,M,I,P,D,T,V,F,H],styles:[".container[_ngcontent-%COMP%]{width:90%;max-width:500px;margin:1rem auto;padding:1.5rem;border-radius:8px;box-shadow:0 4px 6px #0000001a;background:#fff;font-family:sans-serif}.bottom-spacer[_ngcontent-%COMP%]{height:80px}h1[_ngcontent-%COMP%]{text-align:center;color:#333}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;flex-direction:column}label[_ngcontent-%COMP%]{margin-bottom:.5rem;font-weight:700;color:#555}input[_ngcontent-%COMP%]{padding:.6rem;border:1px solid #ccc;border-radius:4px;font-size:1rem}button[_ngcontent-%COMP%]{width:100%;padding:.8rem;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1.1rem;margin-top:1rem}button[_ngcontent-%COMP%]:disabled{background-color:#ccc}"]})};export{$ as New};
