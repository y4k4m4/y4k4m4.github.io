import{a as V,b as E,c as D,d as F,e as Y,f as K,g as H,h as B,l as $,m as J}from"./chunk-3CL27Y2L.js";import{b as T}from"./chunk-DDQ4ZNGR.js";import{a as q}from"./chunk-I25BBKAA.js";import{g as M,h as P}from"./chunk-52L5DIHH.js";import{Cb as o,Db as C,Eb as k,Ga as p,Hb as O,Ib as I,Oa as S,Ta as R,Y as d,Z as u,a as b,b as N,db as g,eb as x,ib as v,jb as a,kb as n,lb as h,pb as w,sb as s,tb as c}from"./chunk-4Y5VCLLF.js";function W(l,r){if(l&1&&(a(0,"strong"),o(1),n(),o(2," costs ")),l&2){let e=c(2);p(),C(e.itemForm.value.itemName)}}function L(l,r){l&1&&o(0," This item costs ")}function j(l,r){if(l&1&&(a(0,"div",11)(1,"p"),o(2),n(),a(3,"h3",17),o(4),O(5,"currency"),n()()),l&2){let e=c(2);p(2),k("If invested until you retire (in ",e.yearsToRetirement," years), this money could become:"),p(2),C(I(5,2,e.futureValue))}}function Q(l,r){if(l&1){let e=w();a(0,"button",18),s("click",function(){d(e);let i=c(2);return u(i.showReminderOptions=!0)}),o(1,"Remind me"),n()}}function U(l,r){if(l&1){let e=w();a(0,"div",16)(1,"button",19),s("click",function(){d(e);let i=c(2);return u(i.setReminder(1))}),o(2,"1 minute"),n(),a(3,"button",19),s("click",function(){d(e);let i=c(2);return u(i.setReminder(3))}),o(4,"3 minutes"),n(),a(5,"button",19),s("click",function(){d(e);let i=c(2);return u(i.setReminder(5))}),o(6,"5 minutes"),n(),a(7,"button",19),s("click",function(){d(e);let i=c(2);return u(i.setReminder(10))}),o(8,"10 minutes"),n(),a(9,"button",19),s("click",function(){d(e);let i=c(2);return u(i.setReminder(15))}),o(10,"15 minutes"),n(),a(11,"button",19),s("click",function(){d(e);let i=c(2);return u(i.setReminder(30))}),o(12,"30 minutes"),n(),a(13,"button",19),s("click",function(){d(e);let i=c(2);return u(i.setReminder(40))}),o(14,"40 minutes"),n(),a(15,"button",19),s("click",function(){d(e);let i=c(2);return u(i.setReminder(60))}),o(16,"1 hour"),n()()}}function X(l,r){if(l&1){let e=w();a(0,"div",9)(1,"div",10)(2,"h2"),o(3,"Is it worth it?"),n(),a(4,"p"),g(5,W,3,1)(6,L,1,0),a(7,"strong"),o(8),n(),o(9," of your life. "),n(),g(10,j,6,4,"div",11),a(11,"div",12)(12,"button",13),s("click",function(){d(e);let i=c();return u(i.recordDecision(!0))}),o(13,"Yes, Buy it"),n(),a(14,"button",14),s("click",function(){d(e);let i=c();return u(i.recordDecision(!1))}),o(15,"No, Save money"),n(),g(16,Q,2,0,"button",15),n(),g(17,U,17,0,"div",16),n()()}if(l&2){let e=c();p(5),x(e.itemForm.value.itemName?5:6),p(3),C(e.humanReadableTime),p(2),x(e.futureValue>0?10:-1),p(6),x(e.showReminderOptions?-1:16),p(),x(e.showReminderOptions?17:-1)}}var z=class l{constructor(r,e){this.fb=r;this.router=e;this.itemForm=this.fb.group({itemName:[""],price:["",[E.required,E.min(.01)]]})}itemForm;showPopup=!1;showReminderOptions=!1;calculatedHours=0;humanReadableTime="";futureValue=0;yearsToRetirement=0;PROFILE_KEY="user_financial_profile";DECISIONS_KEY="purchase_decisions";REMINDERS_KEY="purchase_reminders";ngOnInit(){this.checkProfile(),this.requestNotificationPermission()}checkProfile(){localStorage.getItem(this.PROFILE_KEY)||this.router.navigate(["/profile"])}async requestNotificationPermission(){"Notification"in window&&await Notification.requestPermission()}calculateCost(){let r=this.itemForm.value.price,e=JSON.parse(localStorage.getItem(this.PROFILE_KEY)||"{}"),t=e.hourlyWage;if(!t&&e.salary){let m=e.avgHoursPerDay||8,_=e.salary,f=e.payFrequency;f==="monthly"?t=_/(21.67*m):f==="bi-weekly"?t=_/(10*m):f==="weekly"&&(t=_/(5*m))}t=t||20;let i=(e.investmentReturn||7)/100;if(this.calculatedHours=r/t,this.humanReadableTime=this.formatHours(this.calculatedHours),e.birthDate&&e.retirementAge){let m=new Date(e.birthDate),_=new Date,f=_.getFullYear()-m.getFullYear(),y=_.getMonth()-m.getMonth();(y<0||y===0&&_.getDate()<m.getDate())&&f--,this.yearsToRetirement=e.retirementAge-f,this.yearsToRetirement>0?this.futureValue=r*Math.pow(1+i,this.yearsToRetirement):this.futureValue=0}this.showPopup=!0}formatHours(r){if(r<1){let i=Math.round(r*60);return`${i} minute${i!==1?"s":""}`}let e=Math.floor(r),t=Math.round((r-e)*60);return t>0?`${e}h ${t}m`:`${e} hour${e!==1?"s":""}`}recordDecision(r){let e=JSON.parse(localStorage.getItem(this.DECISIONS_KEY)||"[]");e.push(N(b({},this.itemForm.value),{hours:this.calculatedHours,formattedTime:this.humanReadableTime,futureValue:this.futureValue,yearsToRetirement:this.yearsToRetirement,bought:r,date:new Date().toISOString()})),localStorage.setItem(this.DECISIONS_KEY,JSON.stringify(e)),r||q({particleCount:150,spread:70,origin:{y:.6},colors:["#4caf50","#81c784","#ffffff"]}),this.closePopup()}async setReminder(r){let e=b({},this.itemForm.value);this.closePopup();try{let t=new Date,i=r*60*1e3;t.setMinutes(t.getMinutes()+r);let m=N(b({},e),{id:Date.now(),hours:this.calculatedHours,formattedTime:this.humanReadableTime,remindAt:t.toISOString(),createdAt:new Date().toISOString()}),_=JSON.parse(localStorage.getItem(this.REMINDERS_KEY)||"[]");if(_.push(m),localStorage.setItem(this.REMINDERS_KEY,JSON.stringify(_)),"serviceWorker"in navigator&&"Notification"in window){let f=await navigator.serviceWorker.ready;setTimeout(()=>{f.showNotification("ByeBuyBye: Still want it?",{body:`${m.itemName||"This item"} costs ${m.formattedTime} of your work. Still worth it?`,icon:"icons/icon-192x192.png",data:{url:"/reminders"},badge:"icons/icon-72x72.png",vibrate:[200,100,200]});let A=JSON.parse(localStorage.getItem(this.REMINDERS_KEY)||"[]").filter(G=>G.id!==m.id);localStorage.setItem(this.REMINDERS_KEY,JSON.stringify(A))},i)}}catch(t){console.error("Reminder failed to set:",t)}}closePopup(){this.showPopup=!1,this.showReminderOptions=!1,this.itemForm.reset()}static \u0275fac=function(e){return new(e||l)(S($),S(T))};static \u0275cmp=R({type:l,selectors:[["app-new"]],decls:16,vars:3,consts:[[1,"container"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","itemName"],["type","text","id","itemName","formControlName","itemName","placeholder","e.g. New Headphones"],["for","price"],["type","number","id","price","formControlName","price","placeholder","0.00"],["type","submit",3,"disabled"],[1,"bottom-spacer"],[1,"modal-overlay"],[1,"modal-content"],[1,"opportunity-cost"],[1,"button-group"],[1,"buy-btn",3,"click"],[1,"cancel-btn",3,"click"],[1,"remind-btn"],[1,"reminder-options"],[1,"fv-amount"],[1,"remind-btn",3,"click"],[3,"click"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"h1"),o(2,"New Desired Item"),n(),a(3,"form",1),s("ngSubmit",function(){return t.calculateCost()}),a(4,"div",2)(5,"label",3),o(6,"What do you want to buy? (Optional)"),n(),h(7,"input",4),n(),a(8,"div",2)(9,"label",5),o(10,"How much does it cost?"),n(),h(11,"input",6),n(),a(12,"button",7),o(13,"Check Labor Cost"),n()()(),h(14,"div",8),g(15,X,18,5,"div",9)),e&2&&(p(3),v("formGroup",t.itemForm),p(9),v("disabled",t.itemForm.invalid),p(3),x(t.showPopup?15:-1))},dependencies:[P,J,Y,V,K,D,F,B,H,M],styles:[".container[_ngcontent-%COMP%]{width:90%;max-width:500px;margin:1rem auto;padding:1.5rem;border-radius:8px;box-shadow:0 4px 6px #0000001a;background:#fff;font-family:sans-serif}.bottom-spacer[_ngcontent-%COMP%]{height:80px}h1[_ngcontent-%COMP%]{text-align:center;color:#333}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;flex-direction:column}label[_ngcontent-%COMP%]{margin-bottom:.5rem;font-weight:700;color:#555}input[_ngcontent-%COMP%]{padding:.6rem;border:1px solid #ccc;border-radius:4px;font-size:1rem}button[_ngcontent-%COMP%]{width:100%;padding:.8rem;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1.1rem;margin-top:1rem}button[_ngcontent-%COMP%]:disabled{background-color:#ccc}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;justify-content:center;align-items:center;z-index:2000}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:16px;text-align:center;max-width:350px;width:85%;box-shadow:0 10px 25px #0003}.opportunity-cost[_ngcontent-%COMP%]{margin:20px 0;padding:15px;background-color:#fff9c4;border-radius:8px;border:1px solid #fbc02d}.opportunity-cost[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#5d4037}.fv-amount[_ngcontent-%COMP%]{margin:8px 0 0;color:#f57f17;font-size:1.5rem}.button-group[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:24px}.buy-btn[_ngcontent-%COMP%]{background-color:#4caf50;margin-top:0}.cancel-btn[_ngcontent-%COMP%]{background-color:#f44336;margin-top:0}.remind-btn[_ngcontent-%COMP%]{grid-column:span 2;background-color:#6c757d;margin-top:0}.reminder-options[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:20px}.opt-btn[_ngcontent-%COMP%]{padding:.6rem;font-size:.9rem;margin-top:0;background-color:#eee;color:#333;border:1px solid #ddd}"]})};export{z as New};
